//-------------------------------------------------------------------------------------------------
// Extern crate includes.
//-------------------------------------------------------------------------------------------------
use anyhow::Result;
use once_cell::sync::Lazy;
use rand::prelude::*;
use specs::shred::{Fetch, FetchMut};
use specs::{prelude::*, Component};

//-------------------------------------------------------------------------------------------------
// Workspace includes.
//-------------------------------------------------------------------------------------------------
use fvr_engine_core::prelude::*;

//-------------------------------------------------------------------------------------------------
// Local includes.
//-------------------------------------------------------------------------------------------------
use crate::actor::*;

//-------------------------------------------------------------------------------------------------
// Constants.
//-------------------------------------------------------------------------------------------------

// Default stack allocation length for goals and tasks.
pub const GOALS_SIZE: usize = 8;

//-------------------------------------------------------------------------------------------------
// Alias for convenience.
//-------------------------------------------------------------------------------------------------
pub type GoalsVec = Vec<Box<dyn Goal + Send + Sync>>;

//-------------------------------------------------------------------------------------------------
// Component for all actors.
//-------------------------------------------------------------------------------------------------
#[derive(Component, Debug)]
#[storage(VecStorage)]
pub struct IsActor(pub Actor);

//-------------------------------------------------------------------------------------------------
// Component to hold current goals for an actor.
//-------------------------------------------------------------------------------------------------
#[derive(Component, Default)]
#[storage(VecStorage)]
pub struct HasGoals {
    // Stack of goals.
    pub goals: GoalsVec,
}

//-------------------------------------------------------------------------------------------------
// Component representing desire to move in a direction.
//-------------------------------------------------------------------------------------------------
#[derive(Component)]
#[storage(VecStorage)]
pub struct WantsToMove {
    pub direction: Direction,
    pub weight: f32,
    pub priority: u8,
}
