//-------------------------------------------------------------------------------------------------
// STD includes.
//-------------------------------------------------------------------------------------------------
use std::sync::{Arc, Mutex};

//-------------------------------------------------------------------------------------------------
// Extern crate includes.
//-------------------------------------------------------------------------------------------------
use specs::{prelude::*, Component};

//-------------------------------------------------------------------------------------------------
// Workspace includes.
//-------------------------------------------------------------------------------------------------
use fvr_engine_core::prelude::*;

//-------------------------------------------------------------------------------------------------
// Local includes.
//-------------------------------------------------------------------------------------------------
use crate::actor::*;
use crate::goals::*;

//-------------------------------------------------------------------------------------------------
// Constants.
//-------------------------------------------------------------------------------------------------

// Default stack allocation length for goals and tasks.
pub const GOALS_SIZE: usize = 8;

//-------------------------------------------------------------------------------------------------
// Aliases for convenience.
//-------------------------------------------------------------------------------------------------
pub type GoalStack = Vec<Box<dyn Goal + Send + Sync>>;
pub type SharedActor = Arc<Mutex<Actor>>;

//-------------------------------------------------------------------------------------------------
// Component for all actors.
//-------------------------------------------------------------------------------------------------
#[derive(Component, Debug)]
#[storage(VecStorage)]
pub struct IsActor(pub SharedActor);

//-------------------------------------------------------------------------------------------------
// Component to hold current goals for an actor.
//-------------------------------------------------------------------------------------------------
#[derive(Component, Default)]
#[storage(VecStorage)]
pub struct HasGoals {
    // Stack of goals.
    pub goals: GoalStack,
}

//-------------------------------------------------------------------------------------------------
// Component representing desire to move in a direction.
//-------------------------------------------------------------------------------------------------
#[derive(Component)]
#[storage(VecStorage)]
pub struct WantsToMove {
    pub direction: Direction,
    pub weight: f32,
    pub priority: u8,
}
